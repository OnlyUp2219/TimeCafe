<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.2 (20251019.1705)
 -->
<!-- Title: external_oauth_flow Pages: 1 -->
<svg width="170pt" height="717pt"
 viewBox="0.00 0.00 170.00 717.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 712.5)">
<title>external_oauth_flow</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-712.5 166,-712.5 166,4 -4,4"/>
<!-- UI -->
<g id="node1" class="node">
<title>UI</title>
<polygon fill="none" stroke="black" points="116,-708.5 44,-708.5 44,-672.5 116,-672.5 116,-708.5"/>
<text xml:space="preserve" text-anchor="middle" x="80" y="-693" font-family="GOST Type A,Arial" font-size="10.00">UI</text>
<text xml:space="preserve" text-anchor="middle" x="80" y="-681" font-family="GOST Type A,Arial" font-size="10.00">Внешний вход</text>
</g>
<!-- START -->
<g id="node2" class="node">
<title>START</title>
<polygon fill="none" stroke="black" points="116,-635.5 44,-635.5 44,-599.5 116,-599.5 116,-635.5"/>
<text xml:space="preserve" text-anchor="middle" x="80" y="-620" font-family="GOST Type A,Arial" font-size="10.00">GET /auth</text>
<text xml:space="preserve" text-anchor="middle" x="80" y="-608" font-family="GOST Type A,Arial" font-size="10.00">/login/provider</text>
</g>
<!-- UI&#45;&gt;START -->
<g id="edge1" class="edge">
<title>UI&#45;&gt;START</title>
<path fill="none" stroke="black" d="M80,-672.31C80,-664.73 80,-655.6 80,-647.04"/>
<polygon fill="black" stroke="black" points="83.5,-647.04 80,-637.04 76.5,-647.04 83.5,-647.04"/>
</g>
<!-- REDIR -->
<g id="node3" class="node">
<title>REDIR</title>
<polygon fill="none" stroke="black" points="116,-562.5 44,-562.5 44,-526.5 116,-526.5 116,-562.5"/>
<text xml:space="preserve" text-anchor="middle" x="80" y="-547" font-family="GOST Type A,Arial" font-size="10.00">Redirect</text>
<text xml:space="preserve" text-anchor="middle" x="80" y="-535" font-family="GOST Type A,Arial" font-size="10.00">OAuth провайдер</text>
</g>
<!-- START&#45;&gt;REDIR -->
<g id="edge2" class="edge">
<title>START&#45;&gt;REDIR</title>
<path fill="none" stroke="black" d="M80,-599.31C80,-591.73 80,-582.6 80,-574.04"/>
<polygon fill="black" stroke="black" points="83.5,-574.04 80,-564.04 76.5,-574.04 83.5,-574.04"/>
</g>
<!-- CB -->
<g id="node4" class="node">
<title>CB</title>
<polygon fill="none" stroke="black" points="116,-489.5 44,-489.5 44,-453.5 116,-453.5 116,-489.5"/>
<text xml:space="preserve" text-anchor="middle" x="80" y="-474" font-family="GOST Type A,Arial" font-size="10.00">Callback</text>
<text xml:space="preserve" text-anchor="middle" x="80" y="-462" font-family="GOST Type A,Arial" font-size="10.00">/provider/callback</text>
</g>
<!-- REDIR&#45;&gt;CB -->
<g id="edge3" class="edge">
<title>REDIR&#45;&gt;CB</title>
<path fill="none" stroke="black" d="M80,-526.31C80,-518.73 80,-509.6 80,-501.04"/>
<polygon fill="black" stroke="black" points="83.5,-501.04 80,-491.04 76.5,-501.04 83.5,-501.04"/>
</g>
<!-- CLAIMS -->
<g id="node5" class="node">
<title>CLAIMS</title>
<polygon fill="none" stroke="black" points="116,-416.5 44,-416.5 44,-380.5 116,-380.5 116,-416.5"/>
<text xml:space="preserve" text-anchor="middle" x="80" y="-401" font-family="GOST Type A,Arial" font-size="10.00">Извлечь</text>
<text xml:space="preserve" text-anchor="middle" x="80" y="-389" font-family="GOST Type A,Arial" font-size="10.00">claims</text>
</g>
<!-- CB&#45;&gt;CLAIMS -->
<g id="edge4" class="edge">
<title>CB&#45;&gt;CLAIMS</title>
<path fill="none" stroke="black" d="M80,-453.31C80,-445.73 80,-436.6 80,-428.04"/>
<polygon fill="black" stroke="black" points="83.5,-428.04 80,-418.04 76.5,-428.04 83.5,-428.04"/>
</g>
<!-- DECUSR -->
<g id="node6" class="node">
<title>DECUSR</title>
<polygon fill="none" stroke="black" points="80,-343.5 44,-325.5 80,-307.5 116,-325.5 80,-343.5"/>
<text xml:space="preserve" text-anchor="middle" x="80" y="-328" font-family="GOST Type A,Arial" font-size="10.00">Есть</text>
<text xml:space="preserve" text-anchor="middle" x="80" y="-316" font-family="GOST Type A,Arial" font-size="10.00">пользователь?</text>
</g>
<!-- CLAIMS&#45;&gt;DECUSR -->
<g id="edge5" class="edge">
<title>CLAIMS&#45;&gt;DECUSR</title>
<path fill="none" stroke="black" d="M80,-380.31C80,-372.84 80,-363.87 80,-355.42"/>
<polygon fill="black" stroke="black" points="83.5,-355.54 80,-345.54 76.5,-355.54 83.5,-355.54"/>
</g>
<!-- CREATE -->
<g id="node7" class="node">
<title>CREATE</title>
<polygon fill="none" stroke="black" points="72,-255 0,-255 0,-219 72,-219 72,-255"/>
<text xml:space="preserve" text-anchor="middle" x="36" y="-239.5" font-family="GOST Type A,Arial" font-size="10.00">Создать +</text>
<text xml:space="preserve" text-anchor="middle" x="36" y="-227.5" font-family="GOST Type A,Arial" font-size="10.00">роль</text>
</g>
<!-- DECUSR&#45;&gt;CREATE -->
<g id="edge6" class="edge">
<title>DECUSR&#45;&gt;CREATE</title>
<path fill="none" stroke="black" d="M72.93,-310.6C66.73,-298.42 57.54,-280.35 49.88,-265.29"/>
<polygon fill="black" stroke="black" points="53.21,-264.12 45.56,-256.8 46.98,-267.3 53.21,-264.12"/>
<text xml:space="preserve" text-anchor="middle" x="72.82" y="-276.2" font-family="Times New Roman,serif" font-size="14.00">Нет</text>
</g>
<!-- LOAD -->
<g id="node8" class="node">
<title>LOAD</title>
<polygon fill="none" stroke="black" points="162,-255 90,-255 90,-219 162,-219 162,-255"/>
<text xml:space="preserve" text-anchor="middle" x="126" y="-239.5" font-family="GOST Type A,Arial" font-size="10.00">Загрузить</text>
<text xml:space="preserve" text-anchor="middle" x="126" y="-227.5" font-family="GOST Type A,Arial" font-size="10.00">профиль</text>
</g>
<!-- DECUSR&#45;&gt;LOAD -->
<g id="edge7" class="edge">
<title>DECUSR&#45;&gt;LOAD</title>
<path fill="none" stroke="black" d="M87.19,-310.98C93.68,-298.78 103.42,-280.47 111.52,-265.24"/>
<polygon fill="black" stroke="black" points="114.49,-267.11 116.09,-256.63 108.31,-263.82 114.49,-267.11"/>
<text xml:space="preserve" text-anchor="middle" x="115" y="-276.2" font-family="Times New Roman,serif" font-size="14.00">Да</text>
</g>
<!-- READY -->
<g id="node9" class="node">
<title>READY</title>
<polygon fill="none" stroke="black" points="116,-182 44,-182 44,-146 116,-146 116,-182"/>
<text xml:space="preserve" text-anchor="middle" x="80" y="-166.5" font-family="GOST Type A,Arial" font-size="10.00">Пользователь</text>
<text xml:space="preserve" text-anchor="middle" x="80" y="-154.5" font-family="GOST Type A,Arial" font-size="10.00">готов</text>
</g>
<!-- CREATE&#45;&gt;READY -->
<g id="edge8" class="edge">
<title>CREATE&#45;&gt;READY</title>
<path fill="none" stroke="black" d="M46.65,-218.81C51.68,-210.7 57.79,-200.84 63.41,-191.78"/>
<polygon fill="black" stroke="black" points="66.36,-193.66 68.65,-183.32 60.41,-189.97 66.36,-193.66"/>
</g>
<!-- LOAD&#45;&gt;READY -->
<g id="edge9" class="edge">
<title>LOAD&#45;&gt;READY</title>
<path fill="none" stroke="black" d="M114.86,-218.81C109.55,-210.62 103.08,-200.62 97.16,-191.48"/>
<polygon fill="black" stroke="black" points="100.23,-189.79 91.86,-183.3 94.36,-193.59 100.23,-189.79"/>
</g>
<!-- TOKENS -->
<g id="node10" class="node">
<title>TOKENS</title>
<polygon fill="none" stroke="black" points="116,-109 44,-109 44,-73 116,-73 116,-109"/>
<text xml:space="preserve" text-anchor="middle" x="80" y="-93.5" font-family="GOST Type A,Arial" font-size="10.00">Выдать</text>
<text xml:space="preserve" text-anchor="middle" x="80" y="-81.5" font-family="GOST Type A,Arial" font-size="10.00">токены</text>
</g>
<!-- READY&#45;&gt;TOKENS -->
<g id="edge10" class="edge">
<title>READY&#45;&gt;TOKENS</title>
<path fill="none" stroke="black" d="M80,-145.81C80,-138.23 80,-129.1 80,-120.54"/>
<polygon fill="black" stroke="black" points="83.5,-120.54 80,-110.54 76.5,-120.54 83.5,-120.54"/>
</g>
<!-- RET -->
<g id="node11" class="node">
<title>RET</title>
<polygon fill="none" stroke="black" points="116,-36 44,-36 44,0 116,0 116,-36"/>
<text xml:space="preserve" text-anchor="middle" x="80" y="-20.5" font-family="GOST Type A,Arial" font-size="10.00">Redirect</text>
<text xml:space="preserve" text-anchor="middle" x="80" y="-8.5" font-family="GOST Type A,Arial" font-size="10.00">returnUrl#tokens</text>
</g>
<!-- TOKENS&#45;&gt;RET -->
<g id="edge11" class="edge">
<title>TOKENS&#45;&gt;RET</title>
<path fill="none" stroke="black" d="M80,-72.81C80,-65.23 80,-56.1 80,-47.54"/>
<polygon fill="black" stroke="black" points="83.5,-47.54 80,-37.54 76.5,-47.54 83.5,-47.54"/>
</g>
</g>
</svg>
