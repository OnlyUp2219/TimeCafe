<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.2 (20251019.1705)
 -->
<!-- Title: external_oauth_flow Pages: 1 -->
<svg width="512pt" height="602pt"
 viewBox="0.00 0.00 512.00 602.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 597.5)">
<title>external_oauth_flow</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-597.5 508,-597.5 508,4 -4,4"/>
<!-- UI -->
<g id="node1" class="node">
<title>UI</title>
<polygon fill="none" stroke="black" points="87,-593.5 15,-593.5 15,-557.5 87,-557.5 87,-593.5"/>
<text xml:space="preserve" text-anchor="middle" x="51" y="-578" font-family="GOST Type A,Arial" font-size="10.00">UI</text>
<text xml:space="preserve" text-anchor="middle" x="51" y="-566" font-family="GOST Type A,Arial" font-size="10.00">Внешний вход</text>
</g>
<!-- REDIR -->
<g id="node2" class="node">
<title>REDIR</title>
<polygon fill="none" stroke="black" points="195,-593.5 123,-593.5 123,-557.5 195,-557.5 195,-593.5"/>
<text xml:space="preserve" text-anchor="middle" x="159" y="-578" font-family="GOST Type A,Arial" font-size="10.00">GET /auth</text>
<text xml:space="preserve" text-anchor="middle" x="159" y="-566" font-family="GOST Type A,Arial" font-size="10.00">/login/provider</text>
</g>
<!-- UI&#45;&gt;REDIR -->
<g id="edge1" class="edge">
<title>UI&#45;&gt;REDIR</title>
<path fill="none" stroke="black" d="M87.28,-575.5C95.28,-575.5 103.28,-575.5 111.27,-575.5"/>
<polygon fill="black" stroke="black" points="111.07,-579 121.07,-575.5 111.07,-572 111.07,-579"/>
</g>
<!-- CHLNG -->
<g id="node3" class="node">
<title>CHLNG</title>
<polygon fill="none" stroke="black" points="72,-520.5 0,-520.5 0,-484.5 72,-484.5 72,-520.5"/>
<text xml:space="preserve" text-anchor="middle" x="36" y="-505" font-family="GOST Type A,Arial" font-size="10.00">Challenge</text>
<text xml:space="preserve" text-anchor="middle" x="36" y="-493" font-family="GOST Type A,Arial" font-size="10.00">провайдер</text>
</g>
<!-- REDIR&#45;&gt;CHLNG -->
<g id="edge2" class="edge">
<title>REDIR&#45;&gt;CHLNG</title>
<path fill="none" stroke="black" d="M128.91,-557.13C112.98,-547.93 93.2,-536.52 75.99,-526.58"/>
<polygon fill="black" stroke="black" points="77.93,-523.66 67.52,-521.69 74.43,-529.72 77.93,-523.66"/>
</g>
<!-- CB -->
<g id="node5" class="node">
<title>CB</title>
<polygon fill="none" stroke="black" points="180,-447.5 108,-447.5 108,-411.5 180,-411.5 180,-447.5"/>
<text xml:space="preserve" text-anchor="middle" x="144" y="-426" font-family="GOST Type A,Arial" font-size="10.00">GET callback</text>
</g>
<!-- REDIR&#45;&gt;CB -->
<!-- AUTH -->
<g id="node4" class="node">
<title>AUTH</title>
<polygon fill="none" stroke="black" points="180,-520.5 108,-520.5 108,-484.5 180,-484.5 180,-520.5"/>
<text xml:space="preserve" text-anchor="middle" x="144" y="-505" font-family="GOST Type A,Arial" font-size="10.00">OAuth</text>
<text xml:space="preserve" text-anchor="middle" x="144" y="-493" font-family="GOST Type A,Arial" font-size="10.00">аутентификация</text>
</g>
<!-- CHLNG&#45;&gt;AUTH -->
<g id="edge3" class="edge">
<title>CHLNG&#45;&gt;AUTH</title>
<path fill="none" stroke="black" d="M72.28,-502.5C80.28,-502.5 88.28,-502.5 96.27,-502.5"/>
<polygon fill="black" stroke="black" points="96.07,-506 106.07,-502.5 96.07,-499 96.07,-506"/>
</g>
<!-- AUTH&#45;&gt;CB -->
<g id="edge4" class="edge">
<title>AUTH&#45;&gt;CB</title>
<path fill="none" stroke="black" d="M138.12,-484.31C137.32,-476.64 137.07,-467.39 137.38,-458.74"/>
<polygon fill="black" stroke="black" points="140.85,-459.25 138.04,-449.04 133.87,-458.78 140.85,-459.25"/>
</g>
<!-- AUTH&#45;&gt;CB -->
<!-- CHK -->
<g id="node6" class="node">
<title>CHK</title>
<polygon fill="none" stroke="black" points="252,-447.5 216,-429.5 252,-411.5 288,-429.5 252,-447.5"/>
<text xml:space="preserve" text-anchor="middle" x="252" y="-432" font-family="GOST Type A,Arial" font-size="10.00">Auth</text>
<text xml:space="preserve" text-anchor="middle" x="252" y="-420" font-family="GOST Type A,Arial" font-size="10.00">успешна?</text>
</g>
<!-- CB&#45;&gt;CHK -->
<g id="edge5" class="edge">
<title>CB&#45;&gt;CHK</title>
<path fill="none" stroke="black" d="M180.28,-429.5C188.06,-429.5 195.84,-429.5 203.62,-429.5"/>
<polygon fill="black" stroke="black" points="203.51,-433 213.51,-429.5 203.51,-426 203.51,-433"/>
</g>
<!-- ERR401 -->
<g id="node7" class="node">
<title>ERR401</title>
<polygon fill="none" stroke="black" points="198,-359 126,-359 126,-323 198,-323 198,-359"/>
<text xml:space="preserve" text-anchor="middle" x="162" y="-343.5" font-family="GOST Type A,Arial" font-size="10.00">401</text>
<text xml:space="preserve" text-anchor="middle" x="162" y="-331.5" font-family="GOST Type A,Arial" font-size="10.00">Unauthorized</text>
</g>
<!-- CHK&#45;&gt;ERR401 -->
<g id="edge6" class="edge">
<title>CHK&#45;&gt;ERR401</title>
<path fill="none" stroke="black" d="M240.23,-417.19C227.05,-404.52 205.26,-383.58 188.03,-367.01"/>
<polygon fill="black" stroke="black" points="190.71,-364.74 181.08,-360.34 185.86,-369.79 190.71,-364.74"/>
<text xml:space="preserve" text-anchor="middle" x="225.94" y="-380.2" font-family="Times New Roman,serif" font-size="14.00">Нет</text>
</g>
<!-- EMAIL -->
<g id="node8" class="node">
<title>EMAIL</title>
<polygon fill="none" stroke="black" points="288,-359 216,-359 216,-323 288,-323 288,-359"/>
<text xml:space="preserve" text-anchor="middle" x="252" y="-343.5" font-family="GOST Type A,Arial" font-size="10.00">Извлечь</text>
<text xml:space="preserve" text-anchor="middle" x="252" y="-331.5" font-family="GOST Type A,Arial" font-size="10.00">email</text>
</g>
<!-- CHK&#45;&gt;EMAIL -->
<g id="edge7" class="edge">
<title>CHK&#45;&gt;EMAIL</title>
<path fill="none" stroke="black" d="M252,-411C252,-399.51 252,-384.2 252,-370.93"/>
<polygon fill="black" stroke="black" points="255.5,-370.99 252,-360.99 248.5,-370.99 255.5,-370.99"/>
<text xml:space="preserve" text-anchor="middle" x="259.88" y="-380.2" font-family="Times New Roman,serif" font-size="14.00">Да</text>
</g>
<!-- CHKEML -->
<g id="node9" class="node">
<title>CHKEML</title>
<polygon fill="none" stroke="black" points="252,-286 216,-268 252,-250 288,-268 252,-286"/>
<text xml:space="preserve" text-anchor="middle" x="252" y="-270.5" font-family="GOST Type A,Arial" font-size="10.00">Email</text>
<text xml:space="preserve" text-anchor="middle" x="252" y="-258.5" font-family="GOST Type A,Arial" font-size="10.00">есть?</text>
</g>
<!-- CHK&#45;&gt;CHKEML -->
<!-- ERR401&#45;&gt;CHKEML -->
<!-- EMAIL&#45;&gt;CHKEML -->
<g id="edge8" class="edge">
<title>EMAIL&#45;&gt;CHKEML</title>
<path fill="none" stroke="black" d="M252,-322.81C252,-315.34 252,-306.37 252,-297.92"/>
<polygon fill="black" stroke="black" points="255.5,-298.04 252,-288.04 248.5,-298.04 255.5,-298.04"/>
</g>
<!-- ERRBAD -->
<g id="node10" class="node">
<title>ERRBAD</title>
<polygon fill="none" stroke="black" points="400,-286 328,-286 328,-250 400,-250 400,-286"/>
<text xml:space="preserve" text-anchor="middle" x="364" y="-270.5" font-family="GOST Type A,Arial" font-size="10.00">400</text>
<text xml:space="preserve" text-anchor="middle" x="364" y="-258.5" font-family="GOST Type A,Arial" font-size="10.00">Bad Request</text>
</g>
<!-- CHKEML&#45;&gt;ERRBAD -->
<g id="edge9" class="edge">
<title>CHKEML&#45;&gt;ERRBAD</title>
<path fill="none" stroke="black" d="M288.98,-268C297.76,-268 307.25,-268 316.43,-268"/>
<polygon fill="black" stroke="black" points="316.3,-271.5 326.3,-268 316.3,-264.5 316.3,-271.5"/>
<text xml:space="preserve" text-anchor="middle" x="308" y="-274.2" font-family="Times New Roman,serif" font-size="14.00">Нет</text>
</g>
<!-- FIND -->
<g id="node11" class="node">
<title>FIND</title>
<polygon fill="none" stroke="black" points="288,-197.5 216,-197.5 216,-161.5 288,-161.5 288,-197.5"/>
<text xml:space="preserve" text-anchor="middle" x="252" y="-182" font-family="GOST Type A,Arial" font-size="10.00">Найти</text>
<text xml:space="preserve" text-anchor="middle" x="252" y="-170" font-family="GOST Type A,Arial" font-size="10.00">пользователя</text>
</g>
<!-- CHKEML&#45;&gt;FIND -->
<g id="edge10" class="edge">
<title>CHKEML&#45;&gt;FIND</title>
<path fill="none" stroke="black" d="M252,-249.5C252,-238.01 252,-222.7 252,-209.43"/>
<polygon fill="black" stroke="black" points="255.5,-209.49 252,-199.49 248.5,-209.49 255.5,-209.49"/>
<text xml:space="preserve" text-anchor="middle" x="259.88" y="-218.7" font-family="Times New Roman,serif" font-size="14.00">Да</text>
</g>
<!-- CHKUSR -->
<g id="node12" class="node">
<title>CHKUSR</title>
<polygon fill="none" stroke="black" points="360,-197.5 324,-179.5 360,-161.5 396,-179.5 360,-197.5"/>
<text xml:space="preserve" text-anchor="middle" x="360" y="-176" font-family="GOST Type A,Arial" font-size="10.00">Найден?</text>
</g>
<!-- CHKEML&#45;&gt;CHKUSR -->
<!-- ERRBAD&#45;&gt;CHKUSR -->
<!-- FIND&#45;&gt;CHKUSR -->
<g id="edge11" class="edge">
<title>FIND&#45;&gt;CHKUSR</title>
<path fill="none" stroke="black" d="M288.28,-179.5C296.06,-179.5 303.84,-179.5 311.62,-179.5"/>
<polygon fill="black" stroke="black" points="311.51,-183 321.51,-179.5 311.51,-176 311.51,-183"/>
</g>
<!-- CREATE -->
<g id="node13" class="node">
<title>CREATE</title>
<polygon fill="none" stroke="black" points="288,-109 216,-109 216,-73 288,-73 288,-109"/>
<text xml:space="preserve" text-anchor="middle" x="252" y="-93.5" font-family="GOST Type A,Arial" font-size="10.00">Создать +</text>
<text xml:space="preserve" text-anchor="middle" x="252" y="-81.5" font-family="GOST Type A,Arial" font-size="10.00">роль client</text>
</g>
<!-- CHKUSR&#45;&gt;CREATE -->
<g id="edge12" class="edge">
<title>CHKUSR&#45;&gt;CREATE</title>
<path fill="none" stroke="black" d="M346.76,-167.89C330.86,-155.16 303.7,-133.4 282.52,-116.44"/>
<polygon fill="black" stroke="black" points="284.74,-113.74 274.74,-110.22 280.36,-119.2 284.74,-113.74"/>
<text xml:space="preserve" text-anchor="middle" x="326.55" y="-130.2" font-family="Times New Roman,serif" font-size="14.00">Нет</text>
</g>
<!-- LINK -->
<g id="node14" class="node">
<title>LINK</title>
<polygon fill="none" stroke="black" points="396,-109 324,-109 324,-73 396,-73 396,-109"/>
<text xml:space="preserve" text-anchor="middle" x="360" y="-93.5" font-family="GOST Type A,Arial" font-size="10.00">Связать</text>
<text xml:space="preserve" text-anchor="middle" x="360" y="-81.5" font-family="GOST Type A,Arial" font-size="10.00">логин</text>
</g>
<!-- CHKUSR&#45;&gt;LINK -->
<g id="edge13" class="edge">
<title>CHKUSR&#45;&gt;LINK</title>
<path fill="none" stroke="black" d="M360,-161C360,-149.51 360,-134.2 360,-120.93"/>
<polygon fill="black" stroke="black" points="363.5,-120.99 360,-110.99 356.5,-120.99 363.5,-120.99"/>
<text xml:space="preserve" text-anchor="middle" x="367.88" y="-130.2" font-family="Times New Roman,serif" font-size="14.00">Да</text>
</g>
<!-- TOKENS -->
<g id="node15" class="node">
<title>TOKENS</title>
<polygon fill="none" stroke="black" points="396,-36 324,-36 324,0 396,0 396,-36"/>
<text xml:space="preserve" text-anchor="middle" x="360" y="-20.5" font-family="GOST Type A,Arial" font-size="10.00">Выдать</text>
<text xml:space="preserve" text-anchor="middle" x="360" y="-8.5" font-family="GOST Type A,Arial" font-size="10.00">токены</text>
</g>
<!-- CHKUSR&#45;&gt;TOKENS -->
<!-- CREATE&#45;&gt;LINK -->
<g id="edge14" class="edge">
<title>CREATE&#45;&gt;LINK</title>
<path fill="none" stroke="black" d="M288.28,-91C296.28,-91 304.28,-91 312.27,-91"/>
<polygon fill="black" stroke="black" points="312.07,-94.5 322.07,-91 312.07,-87.5 312.07,-94.5"/>
</g>
<!-- LINK&#45;&gt;TOKENS -->
<g id="edge15" class="edge">
<title>LINK&#45;&gt;TOKENS</title>
<path fill="none" stroke="black" d="M354.12,-72.81C353.32,-65.14 353.07,-55.89 353.38,-47.24"/>
<polygon fill="black" stroke="black" points="356.85,-47.75 354.04,-37.54 349.87,-47.28 356.85,-47.75"/>
</g>
<!-- LINK&#45;&gt;TOKENS -->
<!-- RETRN -->
<g id="node16" class="node">
<title>RETRN</title>
<polygon fill="none" stroke="black" points="504,-36 432,-36 432,0 504,0 504,-36"/>
<text xml:space="preserve" text-anchor="middle" x="468" y="-20.5" font-family="GOST Type A,Arial" font-size="10.00">Redirect</text>
<text xml:space="preserve" text-anchor="middle" x="468" y="-8.5" font-family="GOST Type A,Arial" font-size="10.00">returnUrl</text>
</g>
<!-- TOKENS&#45;&gt;RETRN -->
<g id="edge16" class="edge">
<title>TOKENS&#45;&gt;RETRN</title>
<path fill="none" stroke="black" d="M396.28,-18C404.28,-18 412.28,-18 420.27,-18"/>
<polygon fill="black" stroke="black" points="420.07,-21.5 430.07,-18 420.07,-14.5 420.07,-21.5"/>
</g>
</g>
</svg>
