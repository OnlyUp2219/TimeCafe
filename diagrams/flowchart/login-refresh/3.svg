<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.2 (20251019.1705)
 -->
<!-- Title: external_oauth_flow Pages: 1 -->
<svg width="294pt" height="425pt"
 viewBox="0.00 0.00 294.00 425.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 420.5)">
<title>external_oauth_flow</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-420.5 290,-420.5 290,4 -4,4"/>
<!-- UI -->
<g id="node1" class="node">
<title>UI</title>
<polygon fill="none" stroke="black" points="72,-416.5 0,-416.5 0,-380.5 72,-380.5 72,-416.5"/>
<text xml:space="preserve" text-anchor="middle" x="36" y="-401" font-family="GOST Type A,Arial" font-size="10.00">UI</text>
<text xml:space="preserve" text-anchor="middle" x="36" y="-389" font-family="GOST Type A,Arial" font-size="10.00">Внешний вход</text>
</g>
<!-- START -->
<g id="node2" class="node">
<title>START</title>
<polygon fill="none" stroke="black" points="180,-416.5 108,-416.5 108,-380.5 180,-380.5 180,-416.5"/>
<text xml:space="preserve" text-anchor="middle" x="144" y="-401" font-family="GOST Type A,Arial" font-size="10.00">GET /auth</text>
<text xml:space="preserve" text-anchor="middle" x="144" y="-389" font-family="GOST Type A,Arial" font-size="10.00">/login/provider</text>
</g>
<!-- UI&#45;&gt;START -->
<g id="edge1" class="edge">
<title>UI&#45;&gt;START</title>
<path fill="none" stroke="black" d="M72.28,-398.5C80.28,-398.5 88.28,-398.5 96.27,-398.5"/>
<polygon fill="black" stroke="black" points="96.07,-402 106.07,-398.5 96.07,-395 96.07,-402"/>
</g>
<!-- REDIR -->
<g id="node3" class="node">
<title>REDIR</title>
<polygon fill="none" stroke="black" points="116,-343.5 44,-343.5 44,-307.5 116,-307.5 116,-343.5"/>
<text xml:space="preserve" text-anchor="middle" x="80" y="-328" font-family="GOST Type A,Arial" font-size="10.00">Redirect</text>
<text xml:space="preserve" text-anchor="middle" x="80" y="-316" font-family="GOST Type A,Arial" font-size="10.00">OAuth провайдер</text>
</g>
<!-- START&#45;&gt;REDIR -->
<g id="edge2" class="edge">
<title>START&#45;&gt;REDIR</title>
<path fill="none" stroke="black" d="M128.51,-380.31C120.8,-371.77 111.34,-361.27 102.83,-351.82"/>
<polygon fill="black" stroke="black" points="105.66,-349.74 96.36,-344.65 100.46,-354.42 105.66,-349.74"/>
</g>
<!-- CB -->
<g id="node4" class="node">
<title>CB</title>
<polygon fill="none" stroke="black" points="224,-343.5 152,-343.5 152,-307.5 224,-307.5 224,-343.5"/>
<text xml:space="preserve" text-anchor="middle" x="188" y="-328" font-family="GOST Type A,Arial" font-size="10.00">Callback</text>
<text xml:space="preserve" text-anchor="middle" x="188" y="-316" font-family="GOST Type A,Arial" font-size="10.00">/provider/callback</text>
</g>
<!-- START&#45;&gt;CB -->
<!-- REDIR&#45;&gt;CB -->
<g id="edge3" class="edge">
<title>REDIR&#45;&gt;CB</title>
<path fill="none" stroke="black" d="M116.28,-325.5C124.28,-325.5 132.28,-325.5 140.27,-325.5"/>
<polygon fill="black" stroke="black" points="140.07,-329 150.07,-325.5 140.07,-322 140.07,-329"/>
</g>
<!-- CLAIMS -->
<g id="node5" class="node">
<title>CLAIMS</title>
<polygon fill="none" stroke="black" points="160,-270.5 88,-270.5 88,-234.5 160,-234.5 160,-270.5"/>
<text xml:space="preserve" text-anchor="middle" x="124" y="-255" font-family="GOST Type A,Arial" font-size="10.00">Извлечь</text>
<text xml:space="preserve" text-anchor="middle" x="124" y="-243" font-family="GOST Type A,Arial" font-size="10.00">claims</text>
</g>
<!-- CB&#45;&gt;CLAIMS -->
<g id="edge4" class="edge">
<title>CB&#45;&gt;CLAIMS</title>
<path fill="none" stroke="black" d="M172.51,-307.31C164.8,-298.77 155.34,-288.27 146.83,-278.82"/>
<polygon fill="black" stroke="black" points="149.66,-276.74 140.36,-271.65 144.46,-281.42 149.66,-276.74"/>
</g>
<!-- DECUSR -->
<g id="node6" class="node">
<title>DECUSR</title>
<polygon fill="none" stroke="black" points="232,-270.5 196,-252.5 232,-234.5 268,-252.5 232,-270.5"/>
<text xml:space="preserve" text-anchor="middle" x="232" y="-255" font-family="GOST Type A,Arial" font-size="10.00">Есть</text>
<text xml:space="preserve" text-anchor="middle" x="232" y="-243" font-family="GOST Type A,Arial" font-size="10.00">пользователь?</text>
</g>
<!-- CB&#45;&gt;DECUSR -->
<!-- CLAIMS&#45;&gt;DECUSR -->
<g id="edge5" class="edge">
<title>CLAIMS&#45;&gt;DECUSR</title>
<path fill="none" stroke="black" d="M160.28,-252.5C168.06,-252.5 175.84,-252.5 183.62,-252.5"/>
<polygon fill="black" stroke="black" points="183.51,-256 193.51,-252.5 183.51,-249 183.51,-256"/>
</g>
<!-- LOAD -->
<g id="node8" class="node">
<title>LOAD</title>
<polygon fill="none" stroke="black" points="178,-182 106,-182 106,-146 178,-146 178,-182"/>
<text xml:space="preserve" text-anchor="middle" x="142" y="-166.5" font-family="GOST Type A,Arial" font-size="10.00">Загрузить</text>
<text xml:space="preserve" text-anchor="middle" x="142" y="-154.5" font-family="GOST Type A,Arial" font-size="10.00">профиль</text>
</g>
<!-- CLAIMS&#45;&gt;LOAD -->
<!-- CREATE -->
<g id="node7" class="node">
<title>CREATE</title>
<polygon fill="none" stroke="black" points="268,-182 196,-182 196,-146 268,-146 268,-182"/>
<text xml:space="preserve" text-anchor="middle" x="232" y="-166.5" font-family="GOST Type A,Arial" font-size="10.00">Создать +</text>
<text xml:space="preserve" text-anchor="middle" x="232" y="-154.5" font-family="GOST Type A,Arial" font-size="10.00">роль</text>
</g>
<!-- DECUSR&#45;&gt;CREATE -->
<g id="edge6" class="edge">
<title>DECUSR&#45;&gt;CREATE</title>
<path fill="none" stroke="black" d="M232,-234C232,-222.51 232,-207.2 232,-193.93"/>
<polygon fill="black" stroke="black" points="235.5,-193.99 232,-183.99 228.5,-193.99 235.5,-193.99"/>
<text xml:space="preserve" text-anchor="middle" x="242.88" y="-203.2" font-family="Times New Roman,serif" font-size="14.00">Нет</text>
</g>
<!-- DECUSR&#45;&gt;LOAD -->
<g id="edge7" class="edge">
<title>DECUSR&#45;&gt;LOAD</title>
<path fill="none" stroke="black" d="M220.23,-240.19C207.05,-227.52 185.26,-206.58 168.03,-190.01"/>
<polygon fill="black" stroke="black" points="170.71,-187.74 161.08,-183.34 165.86,-192.79 170.71,-187.74"/>
<text xml:space="preserve" text-anchor="middle" x="202.94" y="-203.2" font-family="Times New Roman,serif" font-size="14.00">Да</text>
</g>
<!-- READY -->
<g id="node9" class="node">
<title>READY</title>
<polygon fill="none" stroke="black" points="178,-109 106,-109 106,-73 178,-73 178,-109"/>
<text xml:space="preserve" text-anchor="middle" x="142" y="-93.5" font-family="GOST Type A,Arial" font-size="10.00">Пользователь</text>
<text xml:space="preserve" text-anchor="middle" x="142" y="-81.5" font-family="GOST Type A,Arial" font-size="10.00">готов</text>
</g>
<!-- CREATE&#45;&gt;READY -->
<g id="edge8" class="edge">
<title>CREATE&#45;&gt;READY</title>
<path fill="none" stroke="black" d="M210.21,-145.81C199.02,-136.98 185.19,-126.07 172.91,-116.39"/>
<polygon fill="black" stroke="black" points="175.1,-113.66 165.09,-110.21 170.77,-119.15 175.1,-113.66"/>
</g>
<!-- LOAD&#45;&gt;READY -->
<g id="edge9" class="edge">
<title>LOAD&#45;&gt;READY</title>
<path fill="none" stroke="black" d="M142,-145.81C142,-138.23 142,-129.1 142,-120.54"/>
<polygon fill="black" stroke="black" points="145.5,-120.54 142,-110.54 138.5,-120.54 145.5,-120.54"/>
</g>
<!-- TOKENS -->
<g id="node10" class="node">
<title>TOKENS</title>
<polygon fill="none" stroke="black" points="286,-109 214,-109 214,-73 286,-73 286,-109"/>
<text xml:space="preserve" text-anchor="middle" x="250" y="-93.5" font-family="GOST Type A,Arial" font-size="10.00">Выдать</text>
<text xml:space="preserve" text-anchor="middle" x="250" y="-81.5" font-family="GOST Type A,Arial" font-size="10.00">токены</text>
</g>
<!-- LOAD&#45;&gt;TOKENS -->
<!-- READY&#45;&gt;TOKENS -->
<g id="edge10" class="edge">
<title>READY&#45;&gt;TOKENS</title>
<path fill="none" stroke="black" d="M178.28,-91C186.28,-91 194.28,-91 202.27,-91"/>
<polygon fill="black" stroke="black" points="202.07,-94.5 212.07,-91 202.07,-87.5 202.07,-94.5"/>
</g>
<!-- RET -->
<g id="node11" class="node">
<title>RET</title>
<polygon fill="none" stroke="black" points="286,-36 214,-36 214,0 286,0 286,-36"/>
<text xml:space="preserve" text-anchor="middle" x="250" y="-20.5" font-family="GOST Type A,Arial" font-size="10.00">Redirect</text>
<text xml:space="preserve" text-anchor="middle" x="250" y="-8.5" font-family="GOST Type A,Arial" font-size="10.00">returnUrl#tokens</text>
</g>
<!-- TOKENS&#45;&gt;RET -->
<g id="edge11" class="edge">
<title>TOKENS&#45;&gt;RET</title>
<path fill="none" stroke="black" d="M250,-72.81C250,-65.23 250,-56.1 250,-47.54"/>
<polygon fill="black" stroke="black" points="253.5,-47.54 250,-37.54 246.5,-47.54 253.5,-47.54"/>
</g>
</g>
</svg>
